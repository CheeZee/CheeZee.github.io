/**
 * @license sc-angular v0.6.4
 * (c) 2015 Sebis
 * License: Sebis Proprietary
 * https://bitbucket.org/sebischair/sc-angular
 */
!function(){angular.module("sociocortex",["ngStorage","ngResource"]);var a="http://server.sociocortex.com";angular.module("sociocortex").value("scConnection",{baseUri:a,apiVersion:"v1"}),angular.module("sociocortex").config(["$sceDelegateProvider",function(b){b.resourceUrlWhitelist(["self",a+"/api/**"])}])}(),function(){angular.module("sociocortex").service("scAuth",["$localStorage","$q","$http","scUtil",function(a,b,c,d){function e(){return a.userDetails}function f(c,d,e,f){a.credentials={user:c,password:d};var h=b.defer();return g().then(function(b){a.userDetails=b.data,b=e&&angular.isFunction(e)?e(b.data):b.data,h.resolve(b)},function(b){delete a.credentials,delete a.userDetails,f&&angular.isFunction(f)&&(b=f(b)),h.reject(b)}),h.promise}function g(){return j(),b(function(a,b){c({url:d.getFullUrl(d.paths.usersMe),method:"GET"}).then(a,b)})}function h(){delete a.credentials,delete a.userDetails}function i(){return!!a.userDetails}function j(){a.credentials?c.defaults.headers.common.Authorization="Basic "+window.btoa(""+a.credentials.user+":"+a.credentials.password):delete c.defaults.headers.common.Authorization}return{getUser:e,login:f,logout:h,isAuthenticated:i,setAuthorizationHeader:j}}])}(),function(){angular.module("sociocortex").service("scData",["$resource","scUtil","scAuth",function(a,b,c){c.setAuthorizationHeader();var d=a(b.getFullUrl(b.paths.entities+"/:id"),{id:"@id"},{update:{method:"PUT"},queryByEntityType:{method:"GET",url:b.getFullUrl(b.paths.entityTypes+"/:id/"+b.paths.entities),isArray:!0},queryByWorkspace:{method:"GET",url:b.getFullUrl(b.paths.workspaces+"/:id/"+b.paths.entities),isArray:!0},getAttributes:{method:"GET",url:b.getFullUrl(b.paths.entities+"/:id/"+b.paths.attributes),isArray:!0}});d.objectifyAttributes=function(a){function b(a){if(a.attributes||(a.attributes={}),angular.isArray(a.attributes)){var b={};angular.forEach(a.attributes,function(a){b[a.name]=1===a.values.length?a.values[0]:a.values}),a.attributes=b}return a}if(angular.isArray(a)){for(var c=[],d=0;d<a.length;d++)c.push(b(a[d]));return c}return b(a)},d.arrayifyAttributes=function(a){function b(a){if(a.attributes||(a.attributes=[]),angular.isObject(a.attributes)){var b=[];angular.forEach(a.attributes,function(a,c){angular.isUndefined(a)||null==a?b.push({name:c,values:[]}):angular.isArray(a)?b.push({name:c,values:a}):b.push({name:c,values:[a]})}),a.attributes=b}return a}if(angular.isArray(a)){for(var c=[],d=0;d<a.length;d++)c.push(b(a[d]));return c}return b(a)},delete d.query;var e=a(b.getFullUrl(b.paths.workspaces+"/:id"),{id:"@id"},{update:{method:"PUT"},getEntities:{method:"GET",url:b.getFullUrl(b.paths.workspaces+"/:id/"+b.paths.entities),isArray:!0},getEntityTypes:{method:"GET",url:b.getFullUrl(b.paths.workspaces+"/:id/"+b.paths.entityTypes),isArray:!0}}),f=a(b.getFullUrl(b.paths.attributes+"/:id"),{id:"@id"},{update:{method:"PUT"},queryByEntity:{method:"GET",url:b.getFullUrl(b.paths.entities+"/:id/"+b.paths.attributes),isArray:!0}});delete f.query;var g=a(b.getFullUrl(b.paths.tasks+"/:id"),{id:"@id"},{update:{method:"PUT"},getAttributes:{method:"GET",url:b.getFullUrl(b.paths.tasks+"/:id/"+b.paths.attributes),isArray:!0}}),h=a(b.getFullUrl(b.paths.expertises+"/:id"),{id:"@id"},{update:{method:"PUT"}});return{Entity:d,Workspace:e,Attribute:f,Task:g,Expertise:h}}])}(),function(){angular.module("sociocortex").service("scModel",["$resource","scUtil","scAuth",function(a,b,c){c.setAuthorizationHeader();var d=a(b.getFullUrl(b.paths.entityTypes+"/:id"),{id:"@id"},{update:{method:"PUT"},queryByWorkspace:{method:"GET",url:b.getFullUrl(b.paths.workspaces+"/:id/"+b.paths.entityTypes),isArray:!0},getAttributeDefinitions:{method:"GET",url:b.getFullUrl(b.paths.entityTypes+"/:id/"+b.paths.attributeDefinitions),isArray:!0},getEntities:{method:"GET",url:b.getFullUrl(b.paths.entityTypes+"/:id/"+b.paths.entities),isArray:!0}});delete d.query;var e=a(b.getFullUrl(b.paths.attributeDefinitions+"/:id"),{id:"@id"},{update:{method:"PUT"},queryByEntityType:{method:"GET",url:b.getFullUrl(b.paths.entityTypes+"/:id/"+b.paths.attributeDefinitions),isArray:!0}});return delete e.query,{EntityType:d,AttributeDefinition:e}}])}(),function(){angular.module("sociocortex").service("scMxl",["$cacheFactory","$q","$http","scAuth","scUtil",function(a,b,c,d,e){function f(a,c,d,e){var f,g,h,k;angular.isObject(a)?(f=a,angular.isString(c)?(g=c,h=d,k=e):(h=c,k=d)):angular.isString(a)?(restriciton=a,h=c,k=d):angular.isFunction(a)?(h=a,k=c):(f=a,g=c,h=d,k=e);var l=j.get(JSON.stringify(f)),m=b.defer();return l?m.resolve(l):(i({httpMethod:"GET",context:f,mxlMethod:"mxlAutoCompletionHints",params:{restrict:g}},function(a){j.put(JSON.stringify(f),a),h&&angular.isFunction(h)&&(a=h(a)),m.resolve(a)},function(a){k&&angular.isFunction(k)&&(a=k(a)),m.reject(a)}),m.promise)}function g(a,c,d,e){var f,g,h,j;angular.isObject(a)&&angular.isObject(c)?(f=a,g=c,h=d,j=e):angular.isObject(a)&&angular.isFunction(c)?(g=a,h=c,j=d):(f=a,restriction=c,h=d,j=e);var k=b.defer();return i({httpMethod:"POST",context:f,mxlMethod:"mxlQuery",data:g},function(a){h&&angular.isFunction(h)&&(a=h(a)),k.resolve(a)},function(a){j&&angular.isFunction(j)&&(a=j(a)),k.reject(a)}),k.promise}function h(a,c,d,e){var f,g,h,j;angular.isObject(a)&&angular.isObject(c)?(f=a,g=c,h=d,j=e):angular.isObject(a)&&angular.isFunction(c)?(g=a,h=c,j=d):(f=a,restriction=c,h=d,j=e);var k=b.defer();return i({httpMethod:"POST",context:f,mxlMethod:"mxlValidation",data:g},function(a){h&&angular.isFunction(h)&&(a=h(a)),k.resolve(a)},function(a){j&&angular.isFunction(j)&&(a=j(a)),k.reject(a)})}function i(a,b,d){var f="";return a.context&&(a.context.entity?f=e.paths.entities+"/"+a.context.entity.id+"/":a.context.entityType?f=e.paths.entityTypes+"/"+a.context.entityType.id+"/":a.context.workspace&&(f=e.paths.workspaces+"/"+a.context.workspace.id+"/")),f=e.getFullUrl(f+a.mxlMethod),c({method:a.httpMethod,url:f,data:a.data,params:a.params}).then(function(a){return b(a.data)},function(a){return d?d(a.data):void 0})}var j=a("mxlAutoCompleteCache");return d.setAuthorizationHeader(),{autoComplete:f,query:g,validate:h}}])}(),function(){angular.module("sociocortex").service("scPrincipal",["$resource","scUtil","scAuth",function(a,b,c){c.setAuthorizationHeader();var d=a(b.getFullUrl(b.paths.users+"/:id"),{id:"@id"},{update:{method:"PUT"},picture:{method:"GET",url:b.getFullUrl(b.paths.users+"/:id/picture")},me:{method:"GET",url:b.getFullUrl(b.paths.usersMe)},myPicture:{method:"GET",url:b.getFullUrl(b.paths.usersMe+"/picture")}}),e=a(b.getFullUrl(b.paths.groups+"/:id"),{id:"@id"},{update:{method:"PUT"}});return{User:d,Group:e}}])}(),function(){function a(a){function b(a){return function(b){return angular.isObject(b)&&b.href&&b.href.indexOf("/"+a+"/")>0}}function c(b,c){return"/"===b.charAt(b.length-1)&&(b=b.substr(0,b.length-1)),"/"===c.charAt(0)&&(c=c.substr(1,a.baseUri.length-1)),b+"/"+c}function d(a){if(e(a))a=a.href;else if(!angular.isString(a))throw new TypeError("The parameter must be a of type 'link object' or 'string'");var b=f("");if(0!==a.indexOf(b))throw new Error('The given URL does not start with the proper prefix of "'+b+"'");return a.substr(b.length-1)}function e(a){return angular.isObject(a)&&!!a.id&&!!a.href&&!!a.name}function f(b){return c(c(a.baseUri,"api/"+a.apiVersion),b)}function g(){return{entities:"entities",attributes:"attributes",entityTypes:"entityTypes",attributeDefinitions:"attributeDefinitions",workspaces:"workspaces",users:"users",usersMe:"users/me",groups:"groups",derivedAttributeDefinitions:"derivedAttributeDefinitions",customFunctions:"customFunctions",tasks:"tasks",taskDefinitions:"taskDefinitions",expertises:"expertises"}}var h=g();return{getFullUrl:f,getRelativeUrl:d,paths:h,isEntity:b(h.entities),isTask:b(h.tasks),isAttribute:b(h.attributes),isEntityType:b(h.entityTypes),isTaskDefinition:b(h.taskDefinitions),isAttributeDefinition:b(h.attributeDefinitions),isWorkspace:b(h.workspaces),isUser:b(h.users),isGroup:b(h.groups),isDerivedAttributeDefinition:b(h.derivedAttributeDefinitions),isCustomFunction:b(h.customFunctions)}}angular.module("sociocortex").service("scUtil",a),a.$inject=["scConnection"]}();